# Firefly III MCP Server Configuration
#
# This file demonstrates all available configuration options.
# You can override any value using environment variables with the prefix FIREFLY_MCP_
#
# Example environment variables:
#   FIREFLY_MCP_SERVER_URL=https://my-firefly.com/api
#   FIREFLY_MCP_API_TOKEN=your-secret-token
#   FIREFLY_MCP_CLIENT_TIMEOUT=60
#
# Environment variables take precedence over values in this file.
# For production deployments, it's recommended to use environment variables
# for sensitive data like API tokens.

# Server configuration
server:
  # Firefly III API base URL (required)
  # Environment variable: FIREFLY_MCP_SERVER_URL
  url: https://your-firefly-instance.com/api

# API authentication (only for stdio mode)
api:
  # Firefly III Personal Access Token
  # Generate this in Firefly III: Profile -> OAuth -> Personal Access Tokens
  # Environment variable: FIREFLY_MCP_API_TOKEN
  #
  # NOTE: This is only required for STDIO mode.
  # In HTTP mode, clients pass their token via Authorization header.
  # SECURITY: Use environment variable instead of storing token in this file
  token: your-personal-access-token-here

# HTTP client settings
client:
  # Request timeout in seconds (default: 30)
  # Environment variable: FIREFLY_MCP_CLIENT_TIMEOUT
  timeout: 30

# Default limits for API queries
limits:
  # Maximum number of accounts to fetch per request (default: 100)
  # Environment variable: FIREFLY_MCP_LIMITS_ACCOUNTS
  accounts: 100

  # Maximum number of transactions to fetch per request (default: 100)
  # Environment variable: FIREFLY_MCP_LIMITS_TRANSACTIONS
  transactions: 100

  # Maximum number of categories to fetch per request (default: 100)
  # Environment variable: FIREFLY_MCP_LIMITS_CATEGORIES
  categories: 100

  # Maximum number of budgets to fetch per request (default: 100)
  # Environment variable: FIREFLY_MCP_LIMITS_BUDGETS
  budgets: 100

# MCP server metadata
mcp:
  # MCP server name (default: firefly-iii-mcp)
  # Environment variable: FIREFLY_MCP_MCP_NAME
  name: firefly-iii-mcp

  # MCP server version (default: 1.0.0)
  # Environment variable: FIREFLY_MCP_MCP_VERSION
  version: 1.0.0

  # MCP server description (default: MCP server for Firefly III personal finance management)
  # Environment variable: FIREFLY_MCP_MCP_INSTRUCTIONS
  instructions: MCP server for Firefly III personal finance management

# HTTP Transport (alternative to stdio for remote access)
# When enabled, the server runs as an HTTP service instead of stdio
#
# AUTHENTICATION: In HTTP mode, clients must pass their Firefly III Personal
# Access Token via the Authorization header:
#   Authorization: Bearer <firefly-iii-personal-access-token>
#
# The server extracts this token and uses it for Firefly III API calls.
# This allows multi-tenant usage where each client uses their own Firefly III credentials.
http:
  # Enable HTTP transport (default: false)
  # Set to true or use --transport=http CLI flag
  # Environment variable: FIREFLY_MCP_HTTP_ENABLED
  enabled: false

  # HTTP server port (default: 8080)
  # Environment variable: FIREFLY_MCP_HTTP_PORT
  port: 8080

  # HTTP server host (default: 0.0.0.0)
  # Environment variable: FIREFLY_MCP_HTTP_HOST
  host: "0.0.0.0"

  # HTTP timeouts in seconds
  # Environment variables: FIREFLY_MCP_HTTP_READ_TIMEOUT, etc.
  read_timeout: 30
  write_timeout: 30
  idle_timeout: 120

  # MCP session timeout in seconds (default: 300)
  # Sessions idle longer than this are automatically closed
  # Environment variable: FIREFLY_MCP_HTTP_SESSION_TIMEOUT
  session_timeout: 300

  # CORS allowed origins (default: ["*"])
  # Use specific origins in production for security
  # Environment variable: FIREFLY_MCP_HTTP_ALLOWED_ORIGINS
  allowed_origins:
    - "*"

  # Rate limiting (per IP)
  # Environment variables: FIREFLY_MCP_HTTP_RATE_LIMIT, FIREFLY_MCP_HTTP_RATE_BURST
  rate_limit: 10.0    # requests per second
  rate_burst: 20      # burst capacity

# QUICK START:
# 1. Copy this file to config.yaml: cp config.yaml.example config.yaml
# 2. Edit config.yaml and set your server URL and API token
# 3. Run the server: ./mcp-server
#
# STDIO MODE (default, for Claude Desktop):
#   ./mcp-server
#
# HTTP MODE (for remote access):
#   ./mcp-server --transport=http --port=8080
#   # or via environment:
#   FIREFLY_MCP_HTTP_ENABLED=true ./mcp-server
#
#   Clients must pass their Firefly III token in Authorization header:
#   curl -H "Authorization: Bearer <firefly-token>" http://localhost:8080/mcp
#
# PRODUCTION DEPLOYMENT:
# 1. Set environment variables instead of using config file:
#    export FIREFLY_MCP_SERVER_URL=https://your-instance.com/api
#    # For stdio mode only:
#    export FIREFLY_MCP_API_TOKEN=your-token
# 2. Run the server: ./mcp-server
#
# DOCKER DEPLOYMENT (HTTP mode):
# Use environment variables in your docker-compose.yml or Kubernetes manifests:
#   environment:
#     - FIREFLY_MCP_SERVER_URL=https://your-instance.com/api
#     - FIREFLY_MCP_HTTP_ENABLED=true
#     - FIREFLY_MCP_HTTP_PORT=8080
# Note: In HTTP mode, clients pass their own Firefly III token via Authorization header
